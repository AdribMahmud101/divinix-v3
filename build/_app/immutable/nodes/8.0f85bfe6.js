import{s as ee,n as G,h as J,o as te,l as W}from"../chunks/scheduler.0545783f.js";import{S as le,i as ae,g as f,h as u,j as x,f as p,k as d,a as q,m as z,s as C,n as L,c as A,F,x as a,o as N,J as se,A as re}from"../chunks/index.3f9f9994.js";import{e as Y}from"../chunks/each.2de3855a.js";import{W as K,t as Q,b as oe,c as ne}from"../chunks/Toaster.svelte_svelte_type_style_lang.c00290f2.js";import{g as ce}from"../chunks/navigation.0331cceb.js";function X(n,l,e){const t=n.slice();return t[7]=l[e],t}function Z(n){let l,e,t,s,T,k=n[1].length+"",m,E,j,o,_="Click on the user role cell in the table to change a user's role.",D,v,B,b,g,w,S='<tr><th scope="col" class="px-6 py-3">Name</th> <th scope="col" class="px-6 py-3">Email</th> <th scope="col" class="px-6 py-3">Role</th></tr>',U,I,V=Y(n[1]),h=[];for(let r=0;r<V.length;r+=1)h[r]=$(X(n,V,r));return{c(){l=f("div"),e=f("div"),t=f("div"),s=f("div"),T=z("Users ("),m=z(k),E=z(")"),j=C(),o=f("div"),o.textContent=_,D=C(),v=f("hr"),B=C(),b=f("div"),g=f("table"),w=f("thead"),w.innerHTML=S,U=C(),I=f("tbody");for(let r=0;r<h.length;r+=1)h[r].c();this.h()},l(r){l=u(r,"DIV",{class:!0});var c=x(l);e=u(c,"DIV",{class:!0});var i=x(e);t=u(i,"DIV",{class:!0});var y=x(t);s=u(y,"DIV",{class:!0});var H=x(s);T=L(H,"Users ("),m=L(H,k),E=L(H,")"),H.forEach(p),j=A(y),o=u(y,"DIV",{class:!0,"data-svelte-h":!0}),F(o)!=="svelte-e52vsy"&&(o.textContent=_),D=A(y),v=u(y,"HR",{class:!0}),B=A(y),b=u(y,"DIV",{class:!0});var M=x(b);g=u(M,"TABLE",{class:!0});var R=x(g);w=u(R,"THEAD",{class:!0,"data-svelte-h":!0}),F(w)!=="svelte-1516mec"&&(w.innerHTML=S),U=A(R),I=u(R,"TBODY",{});var O=x(I);for(let P=0;P<h.length;P+=1)h[P].l(O);O.forEach(p),R.forEach(p),M.forEach(p),y.forEach(p),i.forEach(p),c.forEach(p),this.h()},h(){d(s,"class","text-2xl font-semibold"),d(o,"class","text-gray-500 text-xs font-medium mt-1"),d(v,"class","my-3 dark:border-gray-600"),d(w,"class","text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"),d(g,"class","w-full text-sm text-left text-gray-500 dark:text-gray-400"),d(b,"class","scrollbar-hidden relative overflow-x-auto whitespace-nowrap svelte-3g4avz"),d(t,"class","flex flex-col justify-center"),d(e,"class","py-10 w-full"),d(l,"class","w-full max-w-3xl px-10 md:px-16 min-h-screen flex flex-col")},m(r,c){q(r,l,c),a(l,e),a(e,t),a(t,s),a(s,T),a(s,m),a(s,E),a(t,j),a(t,o),a(t,D),a(t,v),a(t,B),a(t,b),a(b,g),a(g,w),a(g,U),a(g,I);for(let i=0;i<h.length;i+=1)h[i]&&h[i].m(I,null)},p(r,c){if(c&2&&k!==(k=r[1].length+"")&&N(m,k),c&6){V=Y(r[1]);let i;for(i=0;i<V.length;i+=1){const y=X(r,V,i);h[i]?h[i].p(y,c):(h[i]=$(y),h[i].c(),h[i].m(I,null))}for(;i<h.length;i+=1)h[i].d(1);h.length=V.length}},d(r){r&&p(l),se(h,r)}}}function $(n){let l,e,t,s,T,k,m,E=n[7].name+"",j,o,_,D=n[7].email+"",v,B,b,g,w=n[7].role+"",S,U,I,V;function h(){return n[3](n[7])}return{c(){l=f("tr"),e=f("th"),t=f("div"),s=f("img"),k=C(),m=f("div"),j=z(E),o=C(),_=f("td"),v=z(D),B=C(),b=f("td"),g=f("button"),S=z(w),U=C(),this.h()},l(r){l=u(r,"TR",{class:!0});var c=x(l);e=u(c,"TH",{scope:!0,class:!0});var i=x(e);t=u(i,"DIV",{class:!0});var y=x(t);s=u(y,"IMG",{class:!0,src:!0}),k=A(y),m=u(y,"DIV",{class:!0});var H=x(m);j=L(H,E),H.forEach(p),y.forEach(p),i.forEach(p),o=A(c),_=u(c,"TD",{class:!0});var M=x(_);v=L(M,D),M.forEach(p),B=A(c),b=u(c,"TD",{class:!0});var R=x(b);g=u(R,"BUTTON",{class:!0});var O=x(g);S=L(O,w),O.forEach(p),R.forEach(p),U=A(c),c.forEach(p),this.h()},h(){d(s,"class","rounded-full max-w-[30px] max-h-[30px] object-cover mr-4"),W(s.src,T=n[7].profile_image_url)||d(s,"src",T),d(m,"class","font-semibold md:self-center"),d(t,"class","flex flex-row"),d(e,"scope","row"),d(e,"class","px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"),d(_,"class","px-6 py-4"),d(g,"class","dark:text-white underline"),d(b,"class","px-6 py-4"),d(l,"class","bg-white border-b dark:bg-gray-800 dark:border-gray-700")},m(r,c){q(r,l,c),a(l,e),a(e,t),a(t,s),a(t,k),a(t,m),a(m,j),a(l,o),a(l,_),a(_,v),a(l,B),a(l,b),a(b,g),a(g,S),a(l,U),I||(V=re(g,"click",h),I=!0)},p(r,c){n=r,c&2&&!W(s.src,T=n[7].profile_image_url)&&d(s,"src",T),c&2&&E!==(E=n[7].name+"")&&N(j,E),c&2&&D!==(D=n[7].email+"")&&N(v,D),c&2&&w!==(w=n[7].role+"")&&N(S,w)},d(r){r&&p(l),I=!1,V()}}}function ie(n){let l,e=n[0]&&Z(n);return{c(){l=f("div"),e&&e.c(),this.h()},l(t){l=u(t,"DIV",{class:!0});var s=x(l);e&&e.l(s),s.forEach(p),this.h()},h(){d(l,"class","bg-white dark:bg-gray-800 dark:text-gray-100 min-h-screen w-full flex justify-center font-mona svelte-3g4avz")},m(t,s){q(t,l,s),e&&e.m(l,null)},p(t,[s]){t[0]?e?e.p(t,s):(e=Z(t),e.c(),e.m(l,null)):e&&(e.d(1),e=null)},i:G,o:G,d(t){t&&p(l),e&&e.d()}}}function de(n,l,e){let t,s;J(n,oe,o=>e(4,t=o)),J(n,ne,o=>e(5,s=o));let T=!1,k=[];const m=async(o,_)=>{await fetch(`${K}/users/update/role`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.token}`},body:JSON.stringify({id:o,role:_})}).then(async v=>{if(!v.ok)throw await v.json();return v.json()}).catch(v=>(console.log(v),Q.error(v.detail),null))&&await E()},E=async()=>{const o=await fetch(`${K}/users/`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.token}`}}).then(async _=>{if(!_.ok)throw await _.json();return _.json()}).catch(_=>(console.log(_),Q.error(_.detail),null));e(1,k=o||[])};return te(async()=>{s===null||!s.auth||s.auth&&t&&t.role!=="admin"?await ce("/"):await E(),e(0,T=!0)}),[T,k,m,o=>{o.role==="user"?m(o.id,"admin"):o.role==="pending"?m(o.id,"user"):m(o.id,"pending")}]}class me extends le{constructor(l){super(),ae(this,l,de,ie,ee,{})}}export{me as component};
